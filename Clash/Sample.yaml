# åŸºç¡€ç«¯å£è®¾ç½®ï¼ˆæ··åˆç«¯å£ï¼‰
mixed-port: 7893

# å…è®¸å±€åŸŸç½‘è¿æ¥
allow-lan: true
bind-address: '*'

# è¿è¡Œæ¨¡å¼
mode: rule

# æ—¥å¿—çº§åˆ«
log-level: info

# IPv6
ipv6: true

# UDP
udp: true

# API æ§åˆ¶ç«¯å£
external-controller: 127.0.0.1:9090

# æ€§èƒ½ä¸æŒ‡çº¹è®¾ç½®
# ç»Ÿä¸€å»¶è¿Ÿè®¡ç®— (å»é™¤æ¡æ‰‹ç­‰å¹²æ‰°)
unified-delay: true

# TCP å¹¶å‘ (ä½¿ç”¨æœ€å¿«æ¡æ‰‹çš„ IP)
tcp-concurrent: true

# ä¼ªè£…æŒ‡çº¹ (é˜²æ¢æµ‹)
global-client-fingerprint: chrome

# è¿›ç¨‹åŒ¹é…æ¨¡å¼ (Android/è·¯ç”±å™¨å»ºè®® off èŠ‚çœæ€§èƒ½ï¼ŒWindows å¯æ ¹æ®éœ€è¦å¼€å¯)
find-process-mode: off

# GeoData è§„åˆ™åº“æ›´æ–°è®¾ç½®
geodata-mode: true
geodata-loader: standard
geo-auto-update: true
geo-update-interval: 24

geox-url:
  geoip: "https://raw.githubusercontent.com/Loyalsoldier/v2ray-rules-dat/release/geoip.dat"
  geosite: "https://raw.githubusercontent.com/Loyalsoldier/v2ray-rules-dat/release/geosite.dat"
  mmdb: "https://raw.githubusercontent.com/Loyalsoldier/geoip/release/Country.mmdb"

# Hosts è®¾ç½®
hosts:
  '*.clash.dev': 127.0.0.1
  '.dev': 127.0.0.1
  'alpha.clash.dev': '::1'
  "ip6-localhost": "::1"
  "ip6-loopback": "::1"
  
# é…ç½®æŒä¹…åŒ–ï¼ˆä¿å­˜èŠ‚ç‚¹é€‰æ‹©ä¸ Fake-IP æ˜ å°„ï¼‰
profile:
  store-selected: true
  store-fake-ip: true

# æµé‡å—…æ¢ï¼ˆæå‡åŸŸåè¯†åˆ«èƒ½åŠ›ï¼‰
sniffer:
  enable: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
      
# DNS è®¾ç½®
dns:
  enable: true
  listen: 0.0.0.0:53
  ipv6: false
  
  # Fake-IP æ¨¡å¼
  enhanced-mode: fake-ip 
  fake-ip-range: 198.18.0.1/16
  
  # DNS ç¼“å­˜æ–¹å¼
  cache-algorithm: lru
  
  # ä¼˜å…ˆä½¿ç”¨ H3 åŠ é€Ÿ DoH
  prefer-h3: true
  
  # éµå¾ª Clash åˆ†æµè§„åˆ™
  respect-rules: false
  
  # Fake-IP è¿‡æ»¤åˆ—è¡¨ (è¿”å›çœŸå® IPï¼Œè§£å†³ç‰¹å®šåº”ç”¨å…¼å®¹æ€§é—®é¢˜)
  fake-ip-filter:
    # å±€åŸŸç½‘ä¸æœ¬åœ°æœåŠ¡
    - '*.lan'
    - '*.local'
    - '*.localdomain'
    - '*.home.arpa'
    - '*.localhost'
    - 'localhost.ptlogin2.qq.com'
    - 'WORKGROUP'
    # STUN æœåŠ¡ï¼ˆè¯­éŸ³/æ¸¸æˆ NATï¼‰
    - '+.stun.*'
    - '+.stun.playstation.net'
    - '*.srv.nintendo.net'
    - 'xbox.*.*.microsoft.com'
    - '*.*.xboxlive.com'
    # Windows ç½‘ç»œæ£€æµ‹
    - '*.msftconnecttest.com'
    - '*.msftncsi.com'
    # Android ç½‘ç»œæ£€æµ‹
    - 'connectivitycheck.gstatic.com'
    - 'connectivitycheck.android.com'
    # Google Voice ç‰¹æ®Šè§£æ
    - 'lens.l.google.com'
    # Bilibili CDN
    - '*.mcdn.bilivideo.cn'

  # 1. é»˜è®¤ DNS (Bootstrap DNS)
  # ç”¨äºè§£æä¸‹é¢ nameserver åŸŸåçš„ IPï¼Œå¿…é¡»ä½¿ç”¨å›½å†…çº¯å‡€ DNS
  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29

  # 2. ä¸»è¦ DNS (Foreign DNS)
  # é»˜è®¤æƒ…å†µä¸‹çš„ DNS æœåŠ¡å™¨ï¼ˆé€šå¸¸è¢«è§„åˆ™åˆ¤å®šä¸ºä»£ç†æˆ–æœªåŒ¹é…æ—¶ä½¿ç”¨ï¼‰
  # é…ç½®ä¸ºå›½å¤– DNSï¼ŒClash ä¼šæ‹¦æˆªå¹¶è¿”å› Fake-IPï¼Œå®é™…ç”±ä»£ç†èŠ‚ç‚¹è¿›è¡Œè¿œç¨‹è§£æ
  nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query
    - https://1.1.1.1/dns-query
    - https://8.8.8.8/dns-query

  # 3. åŸŸååˆ†æµç­–ç•¥ (Nameserver Policy)
  # æŒ‡å®š "å›½å†…åŸŸå(geosite:cn)" å’Œ "ç§æœ‰ç½‘ç»œ(geosite:private)" å¿…é¡»èµ°å›½å†… DNS
  # è¿™æ ·æ—¢èƒ½è·å¾—å›½å†… CDN åŠ é€Ÿï¼Œåˆä¸ä¼šæŠŠ DNS è¯·æ±‚æ³„éœ²ç»™å›½å¤–æœåŠ¡å™¨
  nameserver-policy:
    "geosite:cn":
      - https://223.5.5.5/dns-query
      - https://1.12.12.12/dns-query
    # ç§æœ‰åŸŸåå¿…é¡»èµ° systemï¼Œå¦åˆ™ä¼šè¢« DoH é˜»æ–­
    "geosite:private":
      - system

# TUN æ¨¡å¼è®¾ç½® (è™šæ‹Ÿç½‘å¡)
tun:
  enable: true
  # æ··åˆæ¨¡å¼ï¼šTCP èµ°ç³»ç»Ÿæ ˆï¼ŒUDP èµ° gvisor (å…¼å®¹æ€§æœ€å¥½)
  stack: mixed 
  
  # DNS åŠ«æŒ
  dns-hijack:
    - any:53
  
  # è‡ªåŠ¨è®¾ç½®è·¯ç”±
  auto-route: true
  
  # è‡ªåŠ¨æ£€æµ‹å‡ºå£ç½‘å¡
  auto-detect-interface: true
  
  # ä¸¥æ ¼è·¯ç”± (Android å»ºè®®å¼€å¯ï¼Œé˜²æ­¢æµé‡é€šè¿‡ç‰©ç†ç½‘å¡æ³„éœ²)
  # strict-route: false
  
# æœ¬åœ°èŠ‚ç‚¹é…ç½®
proxies: []
  
# æœåŠ¡å™¨è®¢é˜…é…ç½®
proxy-providers:
  Server:
    type: http
    path: ./Provider/Proxy/Server.yaml
    url: https://sub.hotkids.me
    interval: 3600
    proxy: DIRECT
    header:
      User-Agent:
      - "Clash/v1.18.0"
      - "mihomo/1.18.3"
    health-check: 
      enable: true
      url: https://cp.cloudflare.com/generate_204
      interval: 600

proxy-groups:
  # ä»£ç†èŠ‚ç‚¹é€‰é¡¹
  - name: "ğŸ”° Proxy"
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Global.png
    proxies:
      - ğŸ‡­ğŸ‡° Hong Kong
      - ğŸ‡¨ğŸ‡³ Taiwan
      - ğŸ‡¸ğŸ‡¬ Singapore
      - ğŸ‡¯ğŸ‡µ Japan
      - ğŸ‡ºğŸ‡¸ America
      - ğŸ‡ºğŸ‡³ Server
      - ğŸ”˜ DIRECT

  # æµ·å¤–æµåª’ä½“æœåŠ¡
  - name: "ğŸ¬ Streaming"
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Streaming.png
    proxies:
      - ğŸ‡­ğŸ‡° Hong Kong
      - ğŸ‡¨ğŸ‡³ Taiwan
      - ğŸ‡¸ğŸ‡¬ Singapore
      - ğŸ‡¯ğŸ‡µ Japan
      - ğŸ‡ºğŸ‡¸ America
      - ğŸ‡ºğŸ‡³ Server

  # å¤§é™†æµåª’ä½“æœåŠ¡ï¼ˆé¢å‘æ¸¯å°ç‰ˆæœ¬ï¼‰
  - name: "ğŸ“º CNTV"
    type: select
    icon: https://raw.githubusercontent.com/HotKids/Rules/master/Quantumult/X/Images/StreamingCN.png
    proxies:
      - ğŸ”˜ DIRECT
      - ğŸ‡­ğŸ‡° Hong Kong
      - ğŸ‡¨ğŸ‡³ Taiwan
      - ğŸ‡¸ğŸ‡¬ Singapore
    
  # ç‰¹æ®Šä»£ç†æœåŠ¡
  - name: "ğŸ Apple"
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Apple.png
    proxies:
      - ğŸ”˜ DIRECT
      - ğŸ”° Proxy
      - ğŸ‡ºğŸ‡¸ America
      
  - name: "ğŸ¤– AIGC"
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/ChatGPT.png
    proxies:
      - ğŸ‡¸ğŸ‡¬ Singapore
      - ğŸ‡¯ğŸ‡µ Japan
      - ğŸ‡ºğŸ‡¸ America
      - ğŸ”° Proxy
      
  # å»å¹¿å‘Šä»¥åŠéšç§è¿½è¸ªä¿æŠ¤ã€åè¿è¥å•†åŠ«æŒå¼€å…³
  - name: "ğŸš§ AdGuard"
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Clubhouse_2.png
    proxies:
      - â›”ï¸ REJECT
      - ğŸ”˜ DIRECT
      
  # é˜»æ­¢
  - name: "â›”ï¸ REJECT"
    type: select
    hidden: true
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Reject.png
    proxies:
      - REJECT

  # ç›´è¿
  - name: "ğŸ”˜ DIRECT"
    type: select
    hidden: true
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Direct.png
    proxies:
      - DIRECT

  # UN
  - name: "ğŸ‡ºğŸ‡³ Server"
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Clubhouse_1.png
    use:
      - Server

  # HK
  - name: "ğŸ‡­ğŸ‡° Hong Kong"
    type: select
    icon: https://raw.githubusercontent.com/HotKids/Rules/master/Quantumult/X/Images/Flags/HK.png
    filter: 'é¦™æ¸¯|HK|Hong Kong|ğŸ‡­ğŸ‡°'
    use:
      - Server
      
  # TW
  - name: "ğŸ‡¨ğŸ‡³ Taiwan"
    type: select
    icon: https://raw.githubusercontent.com/HotKids/Rules/master/Quantumult/X/Images/Flags/TW.png
    filter: 'å°æ¹¾|TW|Taiwan|ğŸ‡¹ğŸ‡¼|ğŸ‡¨ğŸ‡³'
    use:
      - Server

  # SG
  - name: "ğŸ‡¸ğŸ‡¬ Singapore"
    type: select
    icon: https://raw.githubusercontent.com/HotKids/Rules/master/Quantumult/X/Images/Flags/SG.png
    filter: 'æ–°åŠ å¡|ç‹®åŸ|SG|Singapore|ğŸ‡¸ğŸ‡¬'
    use:
      - Server
      
  # JP
  - name: "ğŸ‡¯ğŸ‡µ Japan"
    type: select
    icon: https://raw.githubusercontent.com/HotKids/Rules/master/Quantumult/X/Images/Flags/JP.png
    filter: 'æ—¥æœ¬|JP|Japan|ğŸ‡¯ğŸ‡µ'
    use:
      - Server
    
  # US
  - name: "ğŸ‡ºğŸ‡¸ America"
    type: select
    icon: https://raw.githubusercontent.com/HotKids/Rules/master/Quantumult/X/Images/Flags/US.png
    filter: 'ç¾å›½|US|USA|America|United States|ğŸ‡ºğŸ‡¸'
    use:
      - Server

# å…³äº Rule Provider è¯·æŸ¥é˜…ï¼šhttps://lancellc.gitbook.io/clash/clash-config-file/rule-provider

rule-providers:
# name: # Provider åç§°
#   type: http # http æˆ– file
#   behavior: classical # æˆ– ipcidrã€domain
#   path: # æ–‡ä»¶è·¯å¾„
#   url: # åªæœ‰å½“ç±»å‹ä¸º HTTP æ—¶æ‰å¯ç”¨ï¼Œæ‚¨ä¸éœ€è¦åœ¨æœ¬åœ°ç©ºé—´ä¸­åˆ›å»ºæ–°æ–‡ä»¶ã€‚
#   interval: # è‡ªåŠ¨æ›´æ–°é—´éš”ï¼Œä»…åœ¨ç±»å‹ä¸º HTTP æ—¶å¯ç”¨

  Unbreak:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Unbreak.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/Unbreak.yaml
    interval: 86400

  HTTPDNS:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Guard/HTTPDNS.yaml
    url: https://raw.githubusercontent.com/VirgilClyne/GetSomeFries/main/ruleset/HTTPDNS.Block.yaml
    interval: 86400
    
  Advertising:
    type: http
    behavior: domain
    path: ./Provider/RuleSet/Guard/Reject.yaml
    url: https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/reject.txt
    interval: 86400
      
  Streaming+:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Streaming/Streaming+.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/Streaming+.yaml
    interval: 86400

  Streaming TW:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Streaming/Streaming_TW.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/Streaming_TW.yaml
    interval: 86400

  Streaming JP:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Streaming/Streaming_JP.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/Streaming_JP.yaml
    interval: 86400

  Streaming US:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Streaming/Streaming_US.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/Streaming_US.yaml
    interval: 86400
    
  Streaming:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Streaming/Streaming.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/Streaming.yaml
    interval: 86400

  CNTV:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Streaming/CNTV.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/CNTV.yaml
    interval: 86400

  AIGC:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Extra/GenAI.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/GenAI.yaml
    interval: 86400
    
  Apple CDN:
    type: http
    behavior: domain
    path: ./Provider/RuleSet/Extra/AppleCDN.yaml
    url: https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/apple.txt
    interval: 86400

  Apple:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Extra/Apple.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/Apple.yaml
    interval: 86400
    
  Global:
    type: http
    behavior: domain
    path: ./Provider/RuleSet/Global.yaml
    url: https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/proxy.txt
    interval: 86400

  China:
    type: http
    behavior: domain
    path: ./Provider/RuleSet/China.yaml
    url: https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/direct.txt
    interval: 86400

  CNASN:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Extra/CNASN.yaml
    url: https://raw.githubusercontent.com/VirgilClyne/GetSomeFries/main/ruleset/ASN.China.yaml
    interval: 86400
    
  CNCIDR:
    type: http
    behavior: ipcidr
    path: ./Provider/RuleSet/Extra/CNCIDR.yaml
    url: https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/cncidr.txt
    interval: 86400
    
  LAN:
    type: http
    behavior: ipcidr
    path: ./Provider/RuleSet/Extra/LANCIDR.yaml
    url: https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/lancidr.txt
    interval: 86400

# è§„åˆ™
rules:
  # Unbreak
  - RULE-SET,Unbreak,ğŸ”˜ DIRECT
  
  # AdBlock
  - RULE-SET,HTTPDNS,ğŸš§ AdGuard
  - RULE-SET,Advertising,ğŸš§ AdGuard

  # Global Area Network

  # Streaming
  - RULE-SET,Streaming+,ğŸ”° Proxy
  - RULE-SET,Streaming TW,ğŸ‡¨ğŸ‡³ Taiwan
  - RULE-SET,Streaming JP,ğŸ‡¯ğŸ‡µ Japan
  - RULE-SET,Streaming US,ğŸ‡ºğŸ‡¸ America
  - RULE-SET,Streaming,ğŸ¬ Streaming
  
  # CNTV
  - RULE-SET,CNTV,ğŸ“º CNTV

  # AIGC
  - RULE-SET,AIGC,ğŸ¤– AIGC
  
  # Apple
  - RULE-SET,Apple CDN,ğŸ”˜ DIRECT
  - RULE-SET,Apple,ğŸ Apple

  # (DNS Cache Pollution) / (IP Blackhole) / (Region-Restricted Access Denied) / (Network Jitter)
  - RULE-SET,Global,ğŸ”° Proxy

  # China Area Network
  - RULE-SET,China,ğŸ”˜ DIRECT
  - RULE-SET,CNASN,ğŸ”˜ DIRECT
  - RULE-SET,CNCIDR,ğŸ”˜ DIRECT
  
  # Local Area Network
  - RULE-SET,LAN,ğŸ”˜ DIRECT
  
  # GeoIP
  - GEOSITE,cn,ğŸ”˜ DIRECT
  - GEOIP,CN,ğŸ”˜ DIRECT
  - GEOSITE,geolocation-!cn,ğŸ”° Proxy
  
  - MATCH,ğŸ”° Proxy
