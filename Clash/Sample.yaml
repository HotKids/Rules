# é€šç”¨è®¾ç½®

# port: 7890 # HTTP(S) ä»£ç†æœåŠ¡å™¨ç«¯å£
# socks-port: 7891 # SOCKS5 ä»£ç†ç«¯å£
mixed-port: 7893 # HTTP(S) å’Œ SOCKS ä»£ç†æ··åˆç«¯å£
# redir-port: 7892 # é€æ˜ä»£ç†ç«¯å£ï¼Œç”¨äº Linux å’Œ MacOS
# tproxy-port: 7893 # é€æ˜ä»£ç†ç«¯å£ï¼Œç”¨äº Linux (TProxy TCP and TProxy UDP)

allow-lan: true # å…è®¸å±€åŸŸç½‘è¿æ¥
bind-address: '*' # ç»‘å®š IP åœ°å€ï¼Œä»…ä½œç”¨äº allow-lan ä¸º trueï¼Œ'*' è¡¨ç¤ºæ‰€æœ‰åœ°å€

mode: rule

# æ—¥å¿—ç­‰çº§ silent/error/warning/info/debug
log-level: info

# å¼€å¯ IPv6 æ€»å¼€å…³ï¼Œå…³é—­é˜»æ–­æ‰€æœ‰ IPv6 é“¾æ¥å’Œå±è”½ DNS è¯·æ±‚ AAAA è®°å½•
ipv6: false

# RESTful API ç›‘å¬åœ°å€
external-controller: 127.0.0.1:9090

# è®¾ç½®å‡ºå£ç½‘å¡
# interface-name: eth0

# æ€§èƒ½è®¾ç½®

# ç»Ÿä¸€å»¶è¿Ÿ
# å»é™¤æ¡æ‰‹ç­‰é¢å¤–å»¶è¿Ÿï¼Œæ›´å‡†ç¡®åæ˜ èŠ‚ç‚¹å»¶è¿Ÿ
unified-delay: true

# TCP å¹¶å‘è¿æ¥æ‰€æœ‰ IPï¼Œå°†ä½¿ç”¨æœ€å¿«æ¡æ‰‹çš„ TCP
tcp-concurrent: true

# å…¨å±€ TLS æŒ‡çº¹ï¼Œä¼˜å…ˆçº§ä½äº proxy å†…çš„ client-fingerprint
# å¯é€‰ï¼šchrome/firefox/safari/ios/random/none
global-client-fingerprint: chrome

# è¿›ç¨‹åŒ¹é…æ¨¡å¼
# always - å¼€å¯ï¼Œå¼ºåˆ¶åŒ¹é…æ‰€æœ‰è¿›ç¨‹
# strict - é»˜è®¤ï¼Œç”± mihomo åˆ¤æ–­æ˜¯å¦å¼€å¯
# off - ä¸åŒ¹é…è¿›ç¨‹ï¼Œæ¨èåœ¨è·¯ç”±å™¨ä¸Šä½¿ç”¨æ­¤æ¨¡å¼
find-process-mode: strict

# è¿æ¥è®¾ç½®

# TCP Keep-Alive é—´éš”
keep-alive-interval: 30

# GeoData è®¾ç½®

# æ˜¯å¦è‡ªåŠ¨æ›´æ–° geodata
geo-auto-update: true

# æ›´æ–°é—´éš”ï¼Œå•ä½ï¼šå°æ—¶
geo-update-interval: 24

# è‡ªå®šä¹‰ geodata url
geox-url:
  geoip: "https://raw.githubusercontent.com/Loyalsoldier/v2ray-rules-dat/release/geoip.dat"
  geosite: "https://raw.githubusercontent.com/Loyalsoldier/v2ray-rules-dat/release/geosite.dat"
  mmdb: "https://raw.githubusercontent.com/Loyalsoldier/geoip/release/Country.mmdb"

# Hosts è®¾ç½®

# ç±»ä¼¼äº /etc/hostsï¼Œä»…æ”¯æŒé…ç½®å•ä¸ª IP
hosts:
  '*.clash.dev': 127.0.0.1
  '.dev': 127.0.0.1
  'localhost': 127.0.0.1

# é…ç½®æŒä¹…åŒ–

profile:
  # å­˜å‚¨ select é€‰æ‹©è®°å½•
  store-selected: true
  # æŒä¹…åŒ– fake-ip
  store-fake-ip: true

# å—…æ¢åŸŸå

sniffer:
  enable: true
  # æ˜¯å¦ä½¿ç”¨å—…æ¢ç»“æœä½œä¸ºå®é™…è®¿é—®ï¼Œé»˜è®¤ true
  # å…¨å±€é…ç½®ï¼Œä¼˜å…ˆçº§ä½äº sniffer.sniff å®é™…é…ç½®
  override-destination: false
  sniff:
    HTTP:
      # éœ€è¦å—…æ¢çš„ç«¯å£
      ports: [80, 8080-8880]
      # å¯è¦†ç›– sniffer.override-destination
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]

# DNS è®¾ç½®

dns:
  enable: true
  # å¼€å¯ DNS æœåŠ¡å™¨ç›‘å¬
  listen: 0.0.0.0:1053
  # false å°†è¿”å› AAAA çš„ç©ºç»“æœ
  ipv6: false

  # ç”¨äºè§£æ nameserverï¼Œfallback ä»¥åŠå…¶ä»– DNS æœåŠ¡å™¨é…ç½®çš„ DNS æœåŠ¡åŸŸå
  # åªèƒ½ä½¿ç”¨çº¯ IP åœ°å€ï¼Œå¯ä½¿ç”¨åŠ å¯† DNS
  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29

  enhanced-mode: fake-ip
  # fake-ip æ± è®¾ç½®
  fake-ip-range: 198.18.0.1/16

  # DNS ç¼“å­˜ç®—æ³•
  cache-algorithm: arc

  # DNS ç¼“å­˜å¤§å°
  cache-size: 4096

  # æ˜¯å¦å¼€å¯ DoH æ”¯æŒ HTTP/3ï¼Œå°†å¹¶å‘å°è¯•
  prefer-h3: false

  # é…ç½®åé¢çš„ nameserverã€fallback å’Œ nameserver-policy å‘ DNS æœåŠ¡å™¨çš„è¿æ¥è¿‡ç¨‹æ˜¯å¦éµå®ˆ rules è§„åˆ™
  # å¦‚æœä¸º falseï¼ˆé»˜è®¤å€¼ï¼‰åˆ™è¿™ä¸‰éƒ¨åˆ†çš„ DNS æœåŠ¡å™¨åœ¨æœªç‰¹åˆ«æŒ‡å®šçš„æƒ…å†µä¸‹ä¼šç›´è¿
  # å¦‚æœä¸º trueï¼Œå°†ä¼šæŒ‰ç…§ rules çš„è§„åˆ™åŒ¹é…é“¾æ¥æ–¹å¼ï¼ˆèµ°ä»£ç†æˆ–ç›´è¿ï¼‰
  respect-rules: false

  # é…ç½® fake-ip-filter çš„åŒ¹é…æ¨¡å¼ï¼Œé»˜è®¤ä¸º blacklistï¼Œå³å¦‚æœåŒ¹é…æˆåŠŸä¸è¿”å› fake-ip
  # å¯è®¾ç½®ä¸º whitelistï¼Œå³åªæœ‰åŒ¹é…æˆåŠŸæ‰è¿”å› fake-ip
  fake-ip-filter-mode: blacklist

  # é…ç½®ä¸ä½¿ç”¨ fake-ip çš„åŸŸå
  fake-ip-filter:
    # å±€åŸŸç½‘ä¸æœ¬åœ°æœåŠ¡
    - '*.lan'
    - '*.local'
    - '*.localdomain'
    - '*.home.arpa'
    - '*.localhost'
    - 'localhost.ptlogin2.qq.com'
    - 'WORKGROUP'
    # STUN æœåŠ¡
    - '+.stun.*'
    - '*.srv.nintendo.net'
    - 'xbox.*.microsoft.com'
    - 'xbox.*.*.microsoft.com'
    - '*.xboxlive.com'
    # ç½‘ç»œæ£€æµ‹
    - '*.msftconnecttest.com'
    - '*.msftncsi.com'
    - 'connectivitycheck.gstatic.com'
    - 'connectivitycheck.android.com'
    - 'connectivitycheck.platform.hicloud.com'
    - 'connect.rom.miui.com'
    - 'captive.apple.com'
    - 'network-test.debian.org'
    - 'detectportal.firefox.com'
    # ç‰¹æ®ŠæœåŠ¡
    - 'lens.l.google.com'
    - '*.mcdn.bilivideo.cn'
    - '*.battlenet.com.cn'
    - '*.battlenet.com'
    - '*.blzstatic.cn'
    - '*.battle.net'
    # Steam
    - '*.cm.steampowered.com'
    - '*.steamcontent.com'
    # Tailscale / ZeroTier
    - '*.tailscale.com'
    - '*.zerotier.com'
    # Spotify
    - '*.spotify.com'

  # DNS ä¸»è¦åŸŸåé…ç½®
  # æ”¯æŒ UDPã€TCPã€DoTã€DoHã€DoQ
  # è¿™éƒ¨åˆ†ä¸ºä¸»è¦ DNS é…ç½®ï¼Œå½±å“æ‰€æœ‰ç›´è¿ï¼Œç¡®ä¿ä½¿ç”¨å¯¹å¤§é™†è§£æç²¾å‡†çš„ DNS
  nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query

# TUN è®¾ç½®

tun:
  enable: true

  # ç½‘ç»œæ ˆæ¨¡å¼
  # system - æ€§èƒ½æœ€é«˜ï¼Œå…¼å®¹æ€§ä¸€èˆ¬
  # gvisor - å…¼å®¹æ€§å¥½ï¼Œæ€§èƒ½è¾ƒä½
  # mixed - TCP èµ°ç³»ç»Ÿæ ˆï¼ŒUDP èµ° gvisorï¼ˆæ¨èï¼‰
  stack: mixed

  # éœ€è¦åŠ«æŒçš„ DNS
  dns-hijack:
    - any:53

  # é…ç½®è·¯ç”±è¡¨
  auto-route: true

  # è‡ªåŠ¨è¯†åˆ«å‡ºå£ç½‘å¡
  auto-detect-interface: true

  # å°†æ‰€æœ‰è¿æ¥è·¯ç”±åˆ° tun æ¥é˜²æ­¢æ³„æ¼ï¼Œä½†ä½ çš„è®¾å¤‡å°†æ— æ³•è¢«å…¶ä»–è®¾å¤‡è®¿é—®
  # strict-route: false

  # å¯ç”¨ auto-route æ—¶ä½¿ç”¨è‡ªå®šä¹‰è·¯ç”±è€Œä¸æ˜¯é»˜è®¤è·¯ç”±
  # route-address:
  #   - 0.0.0.0/1
  #   - 128.0.0.0/1

  # æ’é™¤è·¯ç”±ï¼Œè¿™äº›ç½‘æ®µä¸ç»è¿‡ TUN
  # route-exclude-address:
  #   - 192.168.31.0/24
  
# æœ¬åœ°èŠ‚ç‚¹é…ç½®ï¼ˆè®¢é˜…ä¸ºç©ºï¼‰
proxies: []
  
# æœåŠ¡å™¨è®¢é˜…é…ç½®
proxy-providers:
  Server:
    type: http
    path: ./Provider/Proxy/Server.yaml
    url: https://sub.hotkids.me
    interval: 3600
    proxy: DIRECT
    header:
      User-Agent:
      - "Clash/v1.18.0"
      - "mihomo/1.18.3"
    health-check: 
      enable: true
      url: https://cp.cloudflare.com/generate_204
      interval: 600

proxy-groups:
  # ä»£ç†èŠ‚ç‚¹é€‰é¡¹
  - name: "ğŸ”° Proxy"
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Global.png
    proxies:
      - ğŸ‡­ğŸ‡° Hong Kong
      - ğŸ‡¨ğŸ‡³ Taiwan
      - ğŸ‡¸ğŸ‡¬ Singapore
      - ğŸ‡¯ğŸ‡µ Japan
      - ğŸ‡ºğŸ‡¸ America
      - ğŸ‡ºğŸ‡³ Server
      - ğŸ”˜ DIRECT

  # æµ·å¤–æµåª’ä½“æœåŠ¡
  - name: "ğŸ¬ Streaming"
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Streaming.png
    proxies:
      - ğŸ‡­ğŸ‡° Hong Kong
      - ğŸ‡¨ğŸ‡³ Taiwan
      - ğŸ‡¸ğŸ‡¬ Singapore
      - ğŸ‡¯ğŸ‡µ Japan
      - ğŸ‡ºğŸ‡¸ America
      - ğŸ‡ºğŸ‡³ Server

  # å¤§é™†æµåª’ä½“æœåŠ¡ï¼ˆé¢å‘æ¸¯å°ç‰ˆæœ¬ï¼‰
  - name: "ğŸ“º CNTV"
    type: select
    icon: https://raw.githubusercontent.com/HotKids/Rules/master/Quantumult/X/Images/StreamingCN.png
    proxies:
      - ğŸ”˜ DIRECT
      - ğŸ‡­ğŸ‡° Hong Kong
      - ğŸ‡¨ğŸ‡³ Taiwan
      - ğŸ‡¸ğŸ‡¬ Singapore
    
  # ç‰¹æ®Šä»£ç†æœåŠ¡
  - name: "ğŸ Apple"
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Apple.png
    proxies:
      - ğŸ”˜ DIRECT
      - ğŸ”° Proxy
      - ğŸ‡ºğŸ‡¸ America
      
  - name: "ğŸ¤– AIGC"
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/ChatGPT.png
    proxies:
      - ğŸ‡¸ğŸ‡¬ Singapore
      - ğŸ‡¯ğŸ‡µ Japan
      - ğŸ‡ºğŸ‡¸ America
      - ğŸ”° Proxy
      
  # å»å¹¿å‘Šä»¥åŠéšç§è¿½è¸ªä¿æŠ¤ã€åè¿è¥å•†åŠ«æŒå¼€å…³
  - name: "ğŸš§ AdGuard"
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Clubhouse_2.png
    proxies:
      - â›”ï¸ REJECT
      - ğŸ”˜ DIRECT
      
  # é˜»æ­¢
  - name: "â›”ï¸ REJECT"
    type: select
    hidden: true
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Reject.png
    proxies:
      - REJECT

  # ç›´è¿
  - name: "ğŸ”˜ DIRECT"
    type: select
    hidden: true
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Direct.png
    proxies:
      - DIRECT

  # UN
  - name: "ğŸ‡ºğŸ‡³ Server"
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Clubhouse_1.png
    use:
      - Server

  # HK
  - name: "ğŸ‡­ğŸ‡° Hong Kong"
    type: select
    icon: https://raw.githubusercontent.com/HotKids/Rules/master/Quantumult/X/Images/Flags/HK.png
    filter: 'é¦™æ¸¯|HK|Hong Kong|ğŸ‡­ğŸ‡°'
    use:
      - Server
      
  # TW
  - name: "ğŸ‡¨ğŸ‡³ Taiwan"
    type: select
    icon: https://raw.githubusercontent.com/HotKids/Rules/master/Quantumult/X/Images/Flags/TW.png
    filter: 'å°æ¹¾|TW|Taiwan|ğŸ‡¹ğŸ‡¼|ğŸ‡¨ğŸ‡³'
    use:
      - Server

  # SG
  - name: "ğŸ‡¸ğŸ‡¬ Singapore"
    type: select
    icon: https://raw.githubusercontent.com/HotKids/Rules/master/Quantumult/X/Images/Flags/SG.png
    filter: 'æ–°åŠ å¡|ç‹®åŸ|SG|Singapore|ğŸ‡¸ğŸ‡¬'
    use:
      - Server
      
  # JP
  - name: "ğŸ‡¯ğŸ‡µ Japan"
    type: select
    icon: https://raw.githubusercontent.com/HotKids/Rules/master/Quantumult/X/Images/Flags/JP.png
    filter: 'æ—¥æœ¬|JP|Japan|ğŸ‡¯ğŸ‡µ'
    use:
      - Server
    
  # US
  - name: "ğŸ‡ºğŸ‡¸ America"
    type: select
    icon: https://raw.githubusercontent.com/HotKids/Rules/master/Quantumult/X/Images/Flags/US.png
    filter: 'ç¾å›½|US|USA|America|United States|ğŸ‡ºğŸ‡¸'
    use:
      - Server

# å…³äº Rule Provider è¯·æŸ¥é˜…ï¼šhttps://lancellc.gitbook.io/clash/clash-config-file/rule-provider

rule-providers:
# name: # Provider åç§°
#   type: http # http æˆ– file
#   behavior: classical # æˆ– ipcidrã€domain
#   path: # æ–‡ä»¶è·¯å¾„
#   url: # åªæœ‰å½“ç±»å‹ä¸º HTTP æ—¶æ‰å¯ç”¨ï¼Œæ‚¨ä¸éœ€è¦åœ¨æœ¬åœ°ç©ºé—´ä¸­åˆ›å»ºæ–°æ–‡ä»¶ã€‚
#   interval: # è‡ªåŠ¨æ›´æ–°é—´éš”ï¼Œä»…åœ¨ç±»å‹ä¸º HTTP æ—¶å¯ç”¨

  Unbreak:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Unbreak.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/Unbreak.yaml
    interval: 86400

  HTTPDNS:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Guard/HTTPDNS.yaml
    url: https://raw.githubusercontent.com/VirgilClyne/GetSomeFries/main/ruleset/HTTPDNS.Block.yaml
    interval: 86400
    
  Advertising:
    type: http
    behavior: domain
    path: ./Provider/RuleSet/Guard/Reject.yaml
    url: https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/reject.txt
    interval: 86400
      
  Streaming+:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Streaming/Streaming+.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/Streaming+.yaml
    interval: 86400

  Streaming TW:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Streaming/Streaming_TW.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/Streaming_TW.yaml
    interval: 86400

  Streaming JP:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Streaming/Streaming_JP.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/Streaming_JP.yaml
    interval: 86400

  Streaming US:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Streaming/Streaming_US.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/Streaming_US.yaml
    interval: 86400
    
  Streaming:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Streaming/Streaming.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/Streaming.yaml
    interval: 86400

  CNTV:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Streaming/CNTV.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/CNTV.yaml
    interval: 86400

  AIGC:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Extra/GenAI.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/GenAI.yaml
    interval: 86400
    
  Apple CDN:
    type: http
    behavior: domain
    path: ./Provider/RuleSet/Extra/AppleCDN.yaml
    url: https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/apple.txt
    interval: 86400

  Apple:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Extra/Apple.yaml
    url: https://ruleset.skk.moe/Clash/non_ip/apple_services.txt
    interval: 86400
    
  Global:
    type: http
    behavior: domain
    path: ./Provider/RuleSet/Global.yaml
    url: https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/proxy.txt
    interval: 86400

  China:
    type: http
    behavior: domain
    path: ./Provider/RuleSet/China.yaml
    url: https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/direct.txt
    interval: 86400

  CNASN:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Extra/CNASN.yaml
    url: https://raw.githubusercontent.com/VirgilClyne/GetSomeFries/main/ruleset/ASN.China.yaml
    interval: 86400
    
  CNCIDR:
    type: http
    behavior: ipcidr
    path: ./Provider/RuleSet/Extra/CNCIDR.yaml
    url: https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/cncidr.txt
    interval: 86400
    
  LAN:
    type: http
    behavior: ipcidr
    path: ./Provider/RuleSet/Extra/LANCIDR.yaml
    url: https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/lancidr.txt
    interval: 86400

# è§„åˆ™
rules:
  # Unbreak
  - RULE-SET,Unbreak,ğŸ”˜ DIRECT
  
  # AdBlock
  - RULE-SET,HTTPDNS,ğŸš§ AdGuard
  - RULE-SET,Advertising,ğŸš§ AdGuard

  # Global Area Network

  # Streaming
  - RULE-SET,Streaming+,ğŸ”° Proxy
  - RULE-SET,Streaming TW,ğŸ‡¨ğŸ‡³ Taiwan
  - RULE-SET,Streaming JP,ğŸ‡¯ğŸ‡µ Japan
  - RULE-SET,Streaming US,ğŸ‡ºğŸ‡¸ America
  - RULE-SET,Streaming,ğŸ¬ Streaming
  
  # CNTV
  - RULE-SET,CNTV,ğŸ“º CNTV

  # AIGC
  - RULE-SET,AIGC,ğŸ¤– AIGC
  
  # Apple
  - RULE-SET,Apple CDN,ğŸ”˜ DIRECT
  - RULE-SET,Apple,ğŸ Apple

  # (DNS Cache Pollution) / (IP Blackhole) / (Region-Restricted Access Denied) / (Network Jitter)
  - RULE-SET,Global,ğŸ”° Proxy

  # China Area Network
  - RULE-SET,China,ğŸ”˜ DIRECT
  - RULE-SET,CNASN,ğŸ”˜ DIRECT
  - RULE-SET,CNCIDR,ğŸ”˜ DIRECT
  
  # Local Area Network
  - RULE-SET,LAN,ğŸ”˜ DIRECT
  
  # GeoIP
  - GEOSITE,cn,ğŸ”˜ DIRECT
  - GEOIP,CN,ğŸ”˜ DIRECT
  - GEOSITE,geolocation-!cn,ğŸ”° Proxy
  
  - MATCH,ğŸ”° Proxy
