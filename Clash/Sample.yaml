# é€šç”¨è®¾ç½®

# æ··åˆç«¯å£
# HTTP(S) å’Œ SOCKS ä»£ç†æ··åˆç«¯å£
mixed-port: 7893

# å…è®¸å±€åŸŸç½‘è¿æ¥
allow-lan: true
bind-address: '*' # ç»‘å®šæ‰€æœ‰åœ°å€

# è¿è¡Œæ¨¡å¼
mode: rule

# æ—¥å¿—çº§åˆ«
# å¯é€‰ï¼šsilent/error/warning/info/debug
log-level: info

# IPv6 æ”¯æŒ
# å…³é—­åå°†é˜»æ–­æ‰€æœ‰ IPv6 é“¾æ¥å’Œå±è”½ DNS è¯·æ±‚ AAAA è®°å½•
ipv6: false

# API æ§åˆ¶ç«¯å£
external-controller: 127.0.0.1:9090

# å‡ºç«™æ¥å£
# å¤šç½‘å¡ç¯å¢ƒå¯æŒ‡å®šå‡ºç«™ç½‘å¡
# interface-name: eth0

# æ€§èƒ½è®¾ç½®

# ç»Ÿä¸€å»¶è¿Ÿè®¡ç®—
# å»é™¤æ¡æ‰‹ç­‰å¹²æ‰°ï¼Œæ›´å‡†ç¡®åæ˜ èŠ‚ç‚¹å»¶è¿Ÿ
unified-delay: true

# TCP å¹¶å‘
# ä½¿ç”¨æœ€å¿«æ¡æ‰‹çš„ IPï¼Œå°†å¹¶å‘è¿æ¥æ‰€æœ‰ IP
tcp-concurrent: true

# å…¨å±€ TLS æŒ‡çº¹
# é˜²æ¢æµ‹ï¼Œä¼˜å…ˆä½äº proxy å†…çš„ client-fingerprint
# å¯é€‰ï¼š"chrome","firefox","safari","ios","random","none"
global-client-fingerprint: chrome

# è¿›ç¨‹åŒ¹é…æ¨¡å¼
# always - å¼€å¯ï¼Œå¼ºåˆ¶åŒ¹é…æ‰€æœ‰è¿›ç¨‹
# strict - é»˜è®¤ï¼Œç”± mihomo åˆ¤æ–­æ˜¯å¦å¼€å¯
# off - ä¸åŒ¹é…è¿›ç¨‹ï¼Œæ¨èåœ¨è·¯ç”±å™¨ä¸Šä½¿ç”¨æ­¤æ¨¡å¼
find-process-mode: strict

# è¿æ¥è®¾ç½®

# TCP Keep-Alive é—´éš”
keep-alive-interval: 30

# GeoData è®¾ç½®

# è§„åˆ™åº“è‡ªåŠ¨æ›´æ–°
geo-auto-update: true
geo-update-interval: 24 # æ›´æ–°é—´éš”ï¼ˆå°æ—¶ï¼‰

# GeoData ä¸‹è½½åœ°å€
geox-url:
  geoip: "https://raw.githubusercontent.com/Loyalsoldier/v2ray-rules-dat/release/geoip.dat"
  geosite: "https://raw.githubusercontent.com/Loyalsoldier/v2ray-rules-dat/release/geosite.dat"
  mmdb: "https://raw.githubusercontent.com/Loyalsoldier/geoip/release/Country.mmdb"

# Hosts è®¾ç½®
# ç±»ä¼¼äº /etc/hostsï¼Œä»…æ”¯æŒé…ç½®å•ä¸ª IP
hosts:
  '*.clash.dev': 127.0.0.1
  '.dev': 127.0.0.1
  'localhost': 127.0.0.1

# é…ç½®æŒä¹…åŒ–

# ä¿å­˜èŠ‚ç‚¹é€‰æ‹©ä¸ Fake-IP æ˜ å°„
profile:
  store-selected: true
  store-fake-ip: true

# æµé‡å—…æ¢

# æå‡åŸŸåè¯†åˆ«èƒ½åŠ›
sniffer:
  enable: true
  # å…¨å±€é…ç½®ï¼Œä¼˜å…ˆçº§ä½äº sniff å†…çš„å®é™…é…ç½®
  override-destination: false
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true # è¦†ç›–å…¨å±€é…ç½®
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]

# DNS è®¾ç½®

dns:
  enable: true
  listen: 0.0.0.0:1053
  ipv6: false # ä¸è¿”å› AAAA è®°å½•

  # Fake-IP æ¨¡å¼
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16

  # DNS ç¼“å­˜ç®—æ³•
  # lru - æœ€è¿‘æœ€å°‘ä½¿ç”¨
  # arc - è‡ªé€‚åº”ç¼“å­˜æ›¿æ¢ï¼ˆæ¨èï¼‰
  cache-algorithm: arc

  # DNS ç¼“å­˜å¤§å°
  # é»˜è®¤ 1024ï¼Œå¯æ ¹æ®éœ€è¦è°ƒæ•´
  cache-size: 4096

  # HTTP/3 æ”¯æŒ
  # å›½å†… DoH æœåŠ¡å™¨å¯¹ H3 æ”¯æŒä¸ç¨³å®šï¼Œå»ºè®®å…³é—­
  prefer-h3: false

  # éµå¾ªåˆ†æµè§„åˆ™
  # falseï¼ˆæ¨èï¼‰- DNS æœåŠ¡å™¨ç›´è¿ï¼Œæ€§èƒ½æœ€ä¼˜
  # true - DNS æœåŠ¡å™¨éµå®ˆ rules è§„åˆ™
  respect-rules: false

  # Fake-IP è¿‡æ»¤åˆ—è¡¨
  # åŒ¹é…çš„åŸŸåè¿”å›çœŸå® IPï¼Œè§£å†³ç‰¹å®šåº”ç”¨å…¼å®¹æ€§é—®é¢˜
  fake-ip-filter:
    # å±€åŸŸç½‘ä¸æœ¬åœ°æœåŠ¡
    - '*.lan'
    - '*.local'
    - '*.localdomain'
    - '*.home.arpa'
    - '*.localhost'
    - 'localhost.ptlogin2.qq.com'
    - 'WORKGROUP'
    # STUN æœåŠ¡
    - '+.stun.*'
    - '*.srv.nintendo.net'
    - 'xbox.*.microsoft.com'
    - 'xbox.*.*.microsoft.com'
    - '*.xboxlive.com'
    # ç½‘ç»œæ£€æµ‹
    - '*.msftconnecttest.com'
    - '*.msftncsi.com'
    - 'connectivitycheck.gstatic.com'
    - 'connectivitycheck.android.com'
    - 'connectivitycheck.platform.hicloud.com'
    - 'connect.rom.miui.com'
    - 'captive.apple.com'
    - 'network-test.debian.org'
    - 'detectportal.firefox.com'
    # ç‰¹æ®ŠæœåŠ¡
    - 'lens.l.google.com'
    - '*.mcdn.bilivideo.cn'
    - '*.battlenet.com.cn'
    - '*.battlenet.com'
    - '*.blzstatic.cn'
    - '*.battle.net'
    # Steam
    - '*.cm.steampowered.com'
    - '*.steamcontent.com'
    # Tailscale / ZeroTier
    - '*.tailscale.com'
    - '*.zerotier.com'
    # Spotify
    - '*.spotify.com'

  # Fake-IP è¿‡æ»¤æ¨¡å¼
  # blacklist - é»‘åå•ï¼ŒåŒ¹é…åˆ™ä¸è¿”å› fake-ip
  # whitelist - ç™½åå•ï¼Œä»…åŒ¹é…æ‰è¿”å› fake-ip
  fake-ip-filter-mode: blacklist

  # Bootstrap DNS
  # ç”¨äºè§£æ DNS æœåŠ¡å™¨åŸŸåï¼Œå¿…é¡»ä½¿ç”¨çº¯ IP
  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29

  # ä¸» DNS æœåŠ¡å™¨
  # é…ç½®ä¸ºå›½å†… DNSï¼Œç¡®ä¿å›½å†…åŸŸåè·å¾—æœ€ä¼˜ CDN
  nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query

  # åŸŸååˆ†æµç­–ç•¥
  # æ ¹æ®åŸŸåç±»å‹ä½¿ç”¨ä¸åŒçš„ DNS æœåŠ¡å™¨
  nameserver-policy:
    # ç§æœ‰åŸŸå
    "geosite:private":
      - system
    # å¹¿å‘Šæ‹¦æˆª
    "geosite:category-ads-all": rcode://success
    # CDN ä¼˜åŒ–åŸŸå
    "+.apple.cn,+.icloud.com.cn":
      - https://dns.alidns.com/dns-query
    "+.taobao.com,+.tmall.com,+.alicdn.com,+.aliyun.com,+.alipay.com":
      - https://dns.alidns.com/dns-query
    "+.qq.com,+.tencent.com,+.weixin.com,+.gtimg.cn":
      - https://doh.pub/dns-query
    "+.jd.com,+.bilibili.com,+.hdslb.com,+.163.com,+.netease.com":
      - https://dns.alidns.com/dns-query
    "+.baidu.com,+.bdstatic.com,+.baidupcs.com":
      - https://dns.alidns.com/dns-query
    "+.douyin.com,+.toutiao.com,+.bytedance.com,+.douyincdn.com":
      - https://dns.alidns.com/dns-query
    "+.xiaohongshu.com,+.xhscdn.com,+.kuaishou.com":
      - https://dns.alidns.com/dns-query
    "+.meituan.com,+.pinduoduo.com":
      - https://dns.alidns.com/dns-query
    # å›½å†…åŸŸå
    "geosite:cn":
      - https://dns.alidns.com/dns-query
      - https://doh.pub/dns-query
    # å›½å¤–åŸŸåï¼ˆå¯ç”¨ HTTP/3ï¼‰
    "geosite:geolocation-!cn":
      - https://dns.cloudflare.com/dns-query#h3=true
      - https://dns.google/dns-query#h3=true

# TUN è®¾ç½®

tun:
  enable: true

  # ç½‘ç»œæ ˆæ¨¡å¼
  # system - æ€§èƒ½æœ€é«˜ï¼Œå…¼å®¹æ€§ä¸€èˆ¬
  # gvisor - å…¼å®¹æ€§å¥½ï¼Œæ€§èƒ½è¾ƒä½
  # mixed - TCP èµ°ç³»ç»Ÿæ ˆï¼ŒUDP èµ° gvisorï¼ˆæ¨èï¼‰
  stack: mixed

  # DNS åŠ«æŒ
  dns-hijack:
    - any:53

  # è‡ªåŠ¨è®¾ç½®è·¯ç”±
  auto-route: true

  # è‡ªåŠ¨æ£€æµ‹å‡ºå£ç½‘å¡
  auto-detect-interface: true

  # ä¸¥æ ¼è·¯ç”±
  # å¼€å¯åè®¾å¤‡å°†æ— æ³•è¢«å…¶ä»–è®¾å¤‡è®¿é—®
  # Android å»ºè®®å¼€å¯ï¼Œé˜²æ­¢æµé‡æ³„éœ²
  # strict-route: false

  # æ’é™¤è·¯ç”±
  # è¿™äº›ç½‘æ®µä¸ç»è¿‡ TUNï¼Œç›´æ¥èµ°ç‰©ç†ç½‘å¡
  # route-exclude-address:
  #   - 192.168.31.0/24
  
# æœ¬åœ°èŠ‚ç‚¹é…ç½®ï¼ˆè®¢é˜…ä¸ºç©ºï¼‰
proxies: []
  
# æœåŠ¡å™¨è®¢é˜…é…ç½®
proxy-providers:
  Server:
    type: http
    path: ./Provider/Proxy/Server.yaml
    url: https://sub.hotkids.me
    interval: 3600
    proxy: DIRECT
    header:
      User-Agent:
      - "Clash/v1.18.0"
      - "mihomo/1.18.3"
    health-check: 
      enable: true
      url: https://cp.cloudflare.com/generate_204
      interval: 600

proxy-groups:
  # ä»£ç†èŠ‚ç‚¹é€‰é¡¹
  - name: "ğŸ”° Proxy"
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Global.png
    proxies:
      - ğŸ‡­ğŸ‡° Hong Kong
      - ğŸ‡¨ğŸ‡³ Taiwan
      - ğŸ‡¸ğŸ‡¬ Singapore
      - ğŸ‡¯ğŸ‡µ Japan
      - ğŸ‡ºğŸ‡¸ America
      - ğŸ‡ºğŸ‡³ Server
      - ğŸ”˜ DIRECT

  # æµ·å¤–æµåª’ä½“æœåŠ¡
  - name: "ğŸ¬ Streaming"
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Streaming.png
    proxies:
      - ğŸ‡­ğŸ‡° Hong Kong
      - ğŸ‡¨ğŸ‡³ Taiwan
      - ğŸ‡¸ğŸ‡¬ Singapore
      - ğŸ‡¯ğŸ‡µ Japan
      - ğŸ‡ºğŸ‡¸ America
      - ğŸ‡ºğŸ‡³ Server

  # å¤§é™†æµåª’ä½“æœåŠ¡ï¼ˆé¢å‘æ¸¯å°ç‰ˆæœ¬ï¼‰
  - name: "ğŸ“º CNTV"
    type: select
    icon: https://raw.githubusercontent.com/HotKids/Rules/master/Quantumult/X/Images/StreamingCN.png
    proxies:
      - ğŸ”˜ DIRECT
      - ğŸ‡­ğŸ‡° Hong Kong
      - ğŸ‡¨ğŸ‡³ Taiwan
      - ğŸ‡¸ğŸ‡¬ Singapore
    
  # ç‰¹æ®Šä»£ç†æœåŠ¡
  - name: "ğŸ Apple"
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Apple.png
    proxies:
      - ğŸ”˜ DIRECT
      - ğŸ”° Proxy
      - ğŸ‡ºğŸ‡¸ America
      
  - name: "ğŸ¤– AIGC"
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/ChatGPT.png
    proxies:
      - ğŸ‡¸ğŸ‡¬ Singapore
      - ğŸ‡¯ğŸ‡µ Japan
      - ğŸ‡ºğŸ‡¸ America
      - ğŸ”° Proxy
      
  # å»å¹¿å‘Šä»¥åŠéšç§è¿½è¸ªä¿æŠ¤ã€åè¿è¥å•†åŠ«æŒå¼€å…³
  - name: "ğŸš§ AdGuard"
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Clubhouse_2.png
    proxies:
      - â›”ï¸ REJECT
      - ğŸ”˜ DIRECT
      
  # é˜»æ­¢
  - name: "â›”ï¸ REJECT"
    type: select
    hidden: true
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Reject.png
    proxies:
      - REJECT

  # ç›´è¿
  - name: "ğŸ”˜ DIRECT"
    type: select
    hidden: true
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Direct.png
    proxies:
      - DIRECT

  # UN
  - name: "ğŸ‡ºğŸ‡³ Server"
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Clubhouse_1.png
    use:
      - Server

  # HK
  - name: "ğŸ‡­ğŸ‡° Hong Kong"
    type: select
    icon: https://raw.githubusercontent.com/HotKids/Rules/master/Quantumult/X/Images/Flags/HK.png
    filter: 'é¦™æ¸¯|HK|Hong Kong|ğŸ‡­ğŸ‡°'
    use:
      - Server
      
  # TW
  - name: "ğŸ‡¨ğŸ‡³ Taiwan"
    type: select
    icon: https://raw.githubusercontent.com/HotKids/Rules/master/Quantumult/X/Images/Flags/TW.png
    filter: 'å°æ¹¾|TW|Taiwan|ğŸ‡¹ğŸ‡¼|ğŸ‡¨ğŸ‡³'
    use:
      - Server

  # SG
  - name: "ğŸ‡¸ğŸ‡¬ Singapore"
    type: select
    icon: https://raw.githubusercontent.com/HotKids/Rules/master/Quantumult/X/Images/Flags/SG.png
    filter: 'æ–°åŠ å¡|ç‹®åŸ|SG|Singapore|ğŸ‡¸ğŸ‡¬'
    use:
      - Server
      
  # JP
  - name: "ğŸ‡¯ğŸ‡µ Japan"
    type: select
    icon: https://raw.githubusercontent.com/HotKids/Rules/master/Quantumult/X/Images/Flags/JP.png
    filter: 'æ—¥æœ¬|JP|Japan|ğŸ‡¯ğŸ‡µ'
    use:
      - Server
    
  # US
  - name: "ğŸ‡ºğŸ‡¸ America"
    type: select
    icon: https://raw.githubusercontent.com/HotKids/Rules/master/Quantumult/X/Images/Flags/US.png
    filter: 'ç¾å›½|US|USA|America|United States|ğŸ‡ºğŸ‡¸'
    use:
      - Server

# å…³äº Rule Provider è¯·æŸ¥é˜…ï¼šhttps://lancellc.gitbook.io/clash/clash-config-file/rule-provider

rule-providers:
# name: # Provider åç§°
#   type: http # http æˆ– file
#   behavior: classical # æˆ– ipcidrã€domain
#   path: # æ–‡ä»¶è·¯å¾„
#   url: # åªæœ‰å½“ç±»å‹ä¸º HTTP æ—¶æ‰å¯ç”¨ï¼Œæ‚¨ä¸éœ€è¦åœ¨æœ¬åœ°ç©ºé—´ä¸­åˆ›å»ºæ–°æ–‡ä»¶ã€‚
#   interval: # è‡ªåŠ¨æ›´æ–°é—´éš”ï¼Œä»…åœ¨ç±»å‹ä¸º HTTP æ—¶å¯ç”¨

  Unbreak:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Unbreak.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/Unbreak.yaml
    interval: 86400

  HTTPDNS:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Guard/HTTPDNS.yaml
    url: https://raw.githubusercontent.com/VirgilClyne/GetSomeFries/main/ruleset/HTTPDNS.Block.yaml
    interval: 86400
    
  Advertising:
    type: http
    behavior: domain
    path: ./Provider/RuleSet/Guard/Reject.yaml
    url: https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/reject.txt
    interval: 86400
      
  Streaming+:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Streaming/Streaming+.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/Streaming+.yaml
    interval: 86400

  Streaming TW:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Streaming/Streaming_TW.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/Streaming_TW.yaml
    interval: 86400

  Streaming JP:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Streaming/Streaming_JP.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/Streaming_JP.yaml
    interval: 86400

  Streaming US:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Streaming/Streaming_US.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/Streaming_US.yaml
    interval: 86400
    
  Streaming:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Streaming/Streaming.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/Streaming.yaml
    interval: 86400

  CNTV:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Streaming/CNTV.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/CNTV.yaml
    interval: 86400

  AIGC:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Extra/GenAI.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/GenAI.yaml
    interval: 86400
    
  Apple CDN:
    type: http
    behavior: domain
    path: ./Provider/RuleSet/Extra/AppleCDN.yaml
    url: https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/apple.txt
    interval: 86400

  Apple:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Extra/Apple.yaml
    url: https://raw.githubusercontent.com/HotKids/Rules/master/Clash/RuleSet/Apple.yaml
    interval: 86400
    
  Global:
    type: http
    behavior: domain
    path: ./Provider/RuleSet/Global.yaml
    url: https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/proxy.txt
    interval: 86400

  China:
    type: http
    behavior: domain
    path: ./Provider/RuleSet/China.yaml
    url: https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/direct.txt
    interval: 86400

  CNASN:
    type: http
    behavior: classical
    path: ./Provider/RuleSet/Extra/CNASN.yaml
    url: https://raw.githubusercontent.com/VirgilClyne/GetSomeFries/main/ruleset/ASN.China.yaml
    interval: 86400
    
  CNCIDR:
    type: http
    behavior: ipcidr
    path: ./Provider/RuleSet/Extra/CNCIDR.yaml
    url: https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/cncidr.txt
    interval: 86400
    
  LAN:
    type: http
    behavior: ipcidr
    path: ./Provider/RuleSet/Extra/LANCIDR.yaml
    url: https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/lancidr.txt
    interval: 86400

# è§„åˆ™
rules:
  # Unbreak
  - RULE-SET,Unbreak,ğŸ”˜ DIRECT
  
  # AdBlock
  - RULE-SET,HTTPDNS,ğŸš§ AdGuard
  - RULE-SET,Advertising,ğŸš§ AdGuard

  # Global Area Network

  # Streaming
  - RULE-SET,Streaming+,ğŸ”° Proxy
  - RULE-SET,Streaming TW,ğŸ‡¨ğŸ‡³ Taiwan
  - RULE-SET,Streaming JP,ğŸ‡¯ğŸ‡µ Japan
  - RULE-SET,Streaming US,ğŸ‡ºğŸ‡¸ America
  - RULE-SET,Streaming,ğŸ¬ Streaming
  
  # CNTV
  - RULE-SET,CNTV,ğŸ“º CNTV

  # AIGC
  - RULE-SET,AIGC,ğŸ¤– AIGC
  
  # Apple
  - RULE-SET,Apple CDN,ğŸ”˜ DIRECT
  - RULE-SET,Apple,ğŸ Apple

  # (DNS Cache Pollution) / (IP Blackhole) / (Region-Restricted Access Denied) / (Network Jitter)
  - RULE-SET,Global,ğŸ”° Proxy

  # China Area Network
  - RULE-SET,China,ğŸ”˜ DIRECT
  - RULE-SET,CNASN,ğŸ”˜ DIRECT
  - RULE-SET,CNCIDR,ğŸ”˜ DIRECT
  
  # Local Area Network
  - RULE-SET,LAN,ğŸ”˜ DIRECT
  
  # GeoIP
  - GEOSITE,cn,ğŸ”˜ DIRECT
  - GEOIP,CN,ğŸ”˜ DIRECT
  - GEOSITE,geolocation-!cn,ğŸ”° Proxy
  
  - MATCH,ğŸ”° Proxy
